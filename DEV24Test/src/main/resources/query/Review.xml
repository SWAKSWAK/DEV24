<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dev24.client.review.dao.ReviewDAO">
	<!-- 리뷰 전체 조회(해당 도서번호에 대해) -->
	<select id="reviewList" parameterType="review" resultType="review">
		SELECT re_num, re_score, c_num, c_nickname, to_char(re_writedate, 'YYYY-MM-DD') re_writedate,
		 re_type, re_content, b_num, pd_num, re_imgurl
		FROM review
		ORDER BY re_num DESC
	</select>
	
	<!-- 리뷰작성 폼에서 도서정보 출력 -->
	<select id="getBookInfo" parameterType="review" resultType="review">
		select book.b_num, b_name, b_author, b_pub, b_price, listcover_imgurl
		from book
		    inner join bookimg
		    on book.b_num = bookimg.b_num and book.b_num = #{b_num}
	</select>
	
	<!-- 리뷰 작성 -->
	<insert id="reviewInsert" parameterType="review">
		insert into review(re_num, re_score, c_num, c_nickname, re_writedate, re_type, re_content, b_num, pd_num, re_imgurl)
		values(re_num_seq.nextval, #{re_score}, #{c_num}, #{c_nickname}, sysdate, #{re_type}, #{re_content},
		 #{b_num}, #{pd_num}, #{re_imgurl, jdbcType=VARCHAR})
	</insert>

</mapper>
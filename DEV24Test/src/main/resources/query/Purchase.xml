<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dev24.client.purchase.dao.PurchaseDAO">
	
	<!-- 주문할 상품 리스트 출력 -->
	<!-- <select id="purchaseForm" parameterType="cart" resultType="cart">
		select crt_num, b_num, b_name, b_price, crt_qty, crt_price, listcover_imgurl, cateone_num
		from cart_view
		where crt_num in #{crt_num}
	</select> -->
	<select id="purchaseForm" parameterType="hashMap" resultType="cart">
		select crt_num, b_num, b_name, b_price, crt_qty, crt_price, listcover_imgurl, cateone_num
		from cart_view
		where crt_num in #{crt_num}
	</select>
	
	
	<!-- 주문 상품 등록 (purchase 삽입 시 pdetail 자동 삽입) -->
	<insert id="purchaseInsert" parameterType="purchase">
		<selectKey keyProperty="p_num" resultType="int" order="AFTER">
			select p_num_seq.currval from dual
		</selectKey>
	
		insert into purchase(p_num, p_sender, p_price, p_zipcode, 
		p_pmethod, p_receiver, p_address, p_senderphone, p_receivephone, c_num, p_buydate)
		values (p_num_seq.nextval, #{p_sender}, #{p_price}, #{p_zipcode}, #{p_pmethod},
		#{p_receiver}, #{p_address}, #{p_senderphone}, #{p_receivephone}, #{c_num}, sysdate)
	</insert>
	
	
	
</mapper>